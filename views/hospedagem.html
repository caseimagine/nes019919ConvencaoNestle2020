<h2>Hospedagem</h2>
<div ng-if="ehSingle(rootScopeUsuario.Order)">
  <p>Sua hospedagem é do tipo "single" (cama única)</p>
</div>
<div ng-if="reservasFeitas">
  <p><span>Seu quarto já foi definido</span>: <strong>{{reservasFeitas.Tipo | tipoDeQuarto}}</strong></p>
</div>
<div ng-if="!temQuartosDisponiveis(hoteis)">
  <p>Não há mais quartos disponíveis</p>
</div>
<div ng-if="rootScopeUsuario.ContagemAcompanhantes > 0">
  <p>Seu{{acompanhantes.length > 1 ? 's' : ''}} colega{{acompanhantes.length > 1 ? 's' : ''}} de quarto já {{acompanhantes.length > 1 ? 'foram' : 'foi'}} definido{{acompanhantes.length > 1 ? 's' : ''}}</p>
  <ul>
    <li ng-repeat="acompanhante in acompanhantes">
      {{acompanhante.Nome}} ( <a href="mailto:{{acompanhante.Email}}">{{acompanhante.Email}}</a> )
    </li>
  </ul>
</div>


<button
  ng-if="!temQuartosDisponiveis(hoteis) || rootScopeUsuario.ContagemAcompanhantes > 0 || ehSingle(rootScopeUsuario.Order) || reservasFeitas"
  class="btn btn-primary" ng-click="proximoPasso()">Próximo passo</button>

<form name="userForm" ng-submit="submitForm(userForm.$valid)"
  ng-if="ehSingle(rootScopeUsuario.Order) == false && rootScopeUsuario.ContagemAcompanhantes === 0 && temQuartosDisponiveis(hoteis) && !reservasFeitas">
  <fieldset>

    <!-- select de tipo de quarto (hospedagem) -->

    <div class="form-group">
      <label for="{{'tipo-de-quarto-' + option.IdHotel}}">Escolha o tipo de quarto </label>
      <div class="radio" ng-repeat="option in hoteis" ng-if="option.QtdeAPS > 0">
        <label>
          <input type="radio" id="" name="{{'tipo-de-quarto-' + option.IdHotel}}" ng-model="hospedagem.tipoDeQuarto"
            ng-value="option" ng-required="true" ng-change="checkRoommatesLimits()">
          {{option.Nome}} - {{option.QtdeAPS}}
        </label>
      </div>
    </div>

    <!-- formulario de busca de roommate -->

    <h3 ng-if="hospedagem.tipoDeQuarto && podeBuscar()">Buscar e adicionar colegas de quarto</h3>
    <div class="form-group" ng-if="hospedagem.tipoDeQuarto && podeBuscar()">
      <label for="{{'tipo-de-quarto-' + option.IdHotel}}">Adicionar colega de quarto</label>
      <div class="input-group">
        <input type="text" class="form-control" ng-model="roommateSap"
          placeholder="Preencha aqui o SAP do seu colega de quarto" my-enter="searchRoommate(roommateSap)">
        <span class="input-group-btn">
          <button class="btn btn-link" type="button" ng-click="searchRoommate(roommateSap)"><i
              class="glyphicon glyphicon-search" ng-if="!searchingRoommate" aria-hidden="true"></i><i
              class="glyphicon glyphicon-refresh fa-spin" aria-hidden="true" ng-if="searchingRoommate"></i></button>
        </span>
      </div>
    </div>

    <!-- alertas de busca de roommate -->

    <div class="alert alert-primary text-center" ng-if="searchRoommateResultNothingFound">SAP não encontrado</div>
    <div class="alert alert-primary text-center" ng-if="roommateAlreadyExists">SAP já incluído</div>
    <div class="alert alert-primary text-center" ng-if="roommatesArrayFull">O número de colegas de quarto excedeu a
      capacidade</div>

    <div ng-repeat="acompanhante in searchRoommateResult">
      <div class="alert alert-primary text-center" ng-if="podeEscolher(acompanhante).resultado == false">
        {{acompanhante.Nome.toUpperCase()}} (<a ng-href="{{'mailto:' + acompanhante.Email}}">{{acompanhante.Email}}</a>)
        {{ podeEscolher(acompanhante).status }}</div>
      <div class="well clearfix" ng-if="podeEscolher(acompanhante).resultado == true">
        <div class="row">
          <div class="col-md-6">
            <p class="h4"><strong>{{acompanhante.Nome.toUpperCase()}}</strong></p>
            <p><small><a ng-href="{{'mailto:' + acompanhante.Email}}">{{acompanhante.Email}}</a></small></p>
          </div>
          <div class="col-md-6">
            <div class="btn-group pull-right" role="group">
              <button type="button" class="btn btn-primary" ng-click="addRoommate(acompanhante)">Escolher</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <h3 ng-if="hospedagem.tipoDeQuarto && roommatesArray.length > 0">Colegas de quarto escolhidos</h3>

    <p ng-if="hospedagem && hospedagem.tipoDeQuarto">Selecionado {{ roommatesArray.length }}
      colega{{ roommatesArray.length > 1 ? 's' : '' }} de quarto. O máximo é {{maximoAcompanhantes()}}.</p>

    <div ng-repeat="acompanhante in roommatesArray">
      <div class="well clearfix">
        <p class="pull-left h4"><strong>{{acompanhante.Nome.toUpperCase()}}</strong></p>
        <div class="btn-group pull-right" role="group">
          <button type="button" class="btn btn-warning" ng-click="removeRoommate(acompanhante)">Cancelar</button>
        </div>
      </div>
    </div>
  </fieldset>

  <div class="alert alert-danger" ng-if="submitDisabled(userForm) == false">
    <span class="glyphicon glyphicon-warning-sign" aria-hidden="true"></span>
    Atenção: ao clicar em enviar a escolha não poderá mais ser alterada,
    tanto para você quanto para seus colegas de quarto.</div>

  <button type="submit" class="btn btn-primary" ng-disabled="submitDisabled(userForm)">Enviar</button>
</form>